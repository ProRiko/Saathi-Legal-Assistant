<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes, viewport-fit=cover">
    <meta name="description" content="Saathi Legal Assistant - Your AI-powered legal companion for consultation, document generation, and legal guidance">
    <meta name="keywords" content="legal assistant, AI lawyer, legal consultation, document generation, Indian law">
    <meta name="theme-color" content="#1a2332">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <meta name="apple-mobile-web-app-title" content="Saathi Legal">
    <meta name="mobile-web-app-capable" content="yes">
    <link rel="manifest" href="manifest.json">
    <link rel="stylesheet" href="styles.css">
    <title>Saathi Legal Assistant - Your AI Legal Companion</title>
</head>
<body>
    <div class="container">
        <!-- Header -->
        <div class="header">
            <div class="logo">üèõÔ∏è</div>
            <h1>Saathi Legal Assistant</h1>
            <p>Your AI-powered legal companion for consultation, document generation, and legal guidance</p>
        </div>

        <div class="main-content">
            <!-- User Details Section -->
            <div class="name-section">
                <h2>Welcome! Let's get started</h2>
                <p>Please enter your details for a personalized consultation experience:</p>
                <div class="name-input-group">
                    <input type="text" id="userName" class="name-input" placeholder="Enter your full name" maxlength="50" style="margin-bottom: 10px;">
                    <input type="tel" id="userPhone" class="name-input" placeholder="Enter your phone number (10 digits)" maxlength="10" pattern="[0-9]{10}">
                    <button onclick="saveDetails()" class="save-name-btn">Save Details</button>
                </div>
                <div id="welcomeMessage" class="welcome-message" style="display: none;"></div>
            </div>

            <!-- Legal Disclaimer -->
            <div class="disclaimer">
                <div class="disclaimer-icon">‚öñÔ∏è</div>
                <h3>IMPORTANT LEGAL DISCLAIMER</h3>
                <p><strong>Please read carefully before proceeding:</strong></p>
                <p>‚Ä¢ This AI assistant provides <strong>general legal information only</strong> and does not constitute legal advice</p>
                <p>‚Ä¢ <strong>Always consult a qualified attorney</strong> for specific legal matters and before making legal decisions</p>
                <p>‚Ä¢ Generated documents are <strong>templates for reference only</strong> and may require customization</p>
                <p>‚Ä¢ We are <strong>not responsible</strong> for the accuracy, completeness, or legal validity of AI-generated content</p>
                <p>‚Ä¢ <strong>Your conversations may be logged</strong> to improve our services</p>
                <p><strong>By proceeding, you acknowledge and accept these terms.</strong></p>
            </div>

            <!-- Features Section -->
            <div class="features">
                <div class="feature-card">
                    <div class="feature-icon">üí¨</div>
                    <h3>AI Legal Consultation</h3>
                    <p>Get instant answers to your legal questions with our advanced AI assistant trained on Indian law</p>
                </div>

                <div class="feature-card">
                    <div class="feature-icon">üìù</div>
                    <h3>Document Generation</h3>
                    <p>Generate professional legal documents including demand notices, rent agreements, and complaints</p>
                </div>

                <div class="feature-card">
                    <div class="feature-icon">üìã</div>
                    <h3>Legal Forms</h3>
                    <p>Access and customize legal forms for rental agreements, employment contracts, and more</p>
                </div>

                <div class="feature-card">
                    <div class="feature-icon">üîí</div>
                    <h3>Secure & Private</h3>
                    <p>Your consultations are secure with rate limiting and privacy protection measures</p>
                </div>
            </div>

            <!-- CTA Section -->
            <div class="cta-section">
                <button id="startBtn" class="start-consulting-btn" onclick="startConsultation()" disabled>
                    üöÄ Start Consultation
                </button>
                <div id="loading" class="loading">
                    <div class="spinner"></div>
                    <p>Preparing your consultation session...</p>
                </div>
            </div>
        </div>

        <!-- Footer -->
        <div class="footer">
            <p>&copy; 2025 Saathi Legal Assistant. Built with ‚ù§Ô∏è for the legal community.</p>
            <p>Made in India üáÆüá≥ | Powered by AI</p>
        </div>
    </div>

    <script>
        let userName = '';
        let userPhone = '';
        
        // Enable start button only after details are saved
        function saveDetails() {
            const nameInput = document.getElementById('userName');
            const phoneInput = document.getElementById('userPhone');
            const name = nameInput.value.trim();
            const phone = phoneInput.value.trim();
            
            if (!name) {
                alert('Please enter your name to continue');
                nameInput.focus();
                return;
            }
            
            if (name.length < 2) {
                alert('Please enter a valid name (at least 2 characters)');
                nameInput.focus();
                return;
            }
            
            if (!phone) {
                alert('Please enter your phone number to continue');
                phoneInput.focus();
                return;
            }
            
            if (!/^[0-9]{10}$/.test(phone)) {
                alert('Please enter a valid 10-digit phone number');
                phoneInput.focus();
                return;
            }
            
            userName = name;
            userPhone = phone;
            
            // Save to localStorage for persistence
            localStorage.setItem('saathi_user_name', userName);
            localStorage.setItem('saathi_user_phone', userPhone);
            
            // Show welcome message
            const welcomeMsg = document.getElementById('welcomeMessage');
            welcomeMsg.innerHTML = `‚úÖ Welcome, ${userName}! Your details have been saved. You can now start your consultation.`;
            welcomeMsg.style.display = 'block';
            
            // Enable start button
            const startBtn = document.getElementById('startBtn');
            startBtn.disabled = false;
            startBtn.style.background = 'linear-gradient(135deg, #667eea 0%, #764ba2 100%)';
            
            // Disable inputs
            nameInput.disabled = true;
            phoneInput.disabled = true;
            document.querySelector('.save-name-btn').disabled = true;
            document.querySelector('.save-name-btn').style.background = '#95a5a6';
            document.querySelector('.save-name-btn').innerHTML = '‚úì Details Saved';
        }
        
        // Check if details already saved
        function checkSavedDetails() {
            const savedName = localStorage.getItem('saathi_user_name');
            const savedPhone = localStorage.getItem('saathi_user_phone');
            if (savedName && savedPhone) {
                document.getElementById('userName').value = savedName;
                document.getElementById('userPhone').value = savedPhone;
                saveDetails();
            }
        }
        
        // Start consultation
        function startConsultation() {
            if (!userName || !userPhone) {
                alert('Please save your details first');
                return;
            }
            
            // Show loading
            document.getElementById('loading').style.display = 'block';
            document.getElementById('startBtn').style.display = 'none';
            
            // Send user details to server for session tracking
            fetch('/api/start-session', {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/json',
                },
                body: JSON.stringify({
                    user_name: userName,
                    user_phone: userPhone,
                    timestamp: new Date().toISOString(),
                    session_id: generateSessionId()
                })
            }).then(response => {
                // Redirect to chat regardless of server response
                setTimeout(() => {
                    window.location.href = 'chat.html';
                }, 2000);
            }).catch(error => {
                // Still redirect even if session logging fails
                console.log('Session logging failed, but continuing...');
                setTimeout(() => {
                    window.location.href = 'chat.html';
                }, 2000);
            });
        }
        
        // Generate unique session ID
        function generateSessionId() {
            return 'session_' + Date.now() + '_' + Math.random().toString(36).substr(2, 9);
        }
        
        // Allow Enter key to save details
        document.getElementById('userName').addEventListener('keypress', function(e) {
            if (e.key === 'Enter') {
                document.getElementById('userPhone').focus();
            }
        });
        
        document.getElementById('userPhone').addEventListener('keypress', function(e) {
            if (e.key === 'Enter') {
                saveDetails();
            }
        });
        
        // Initialize
        checkSavedDetails();
        
        // Auto-focus on name input
        document.getElementById('userName').focus();
    </script>
</body>
</html>
